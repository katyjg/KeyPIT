function dendrogram(a,b){function c(f){function g(a,b){return path=`M ${a.y} ${a.x}
                C ${(a.y+b.y)/2} ${a.x},
                  ${(a.y+b.y)/2} ${b.x},
                  ${b.y} ${b.x}`,path}var h=l(d),i=h.descendants(),m=h.descendants().slice(1);i.forEach(function(a){a.y=a.depth*e.width()/(b.depth+1)});var n=j.selectAll("g.node").data(i,function(a){return a.id||(a.id=++k)}),o=n.enter().append("g").attr("class","node").attr("id",function(a){return"unit-"+a.data.pk}).attr("transform",function(){return"translate("+f.y0+","+f.x0+")"}).on("click",function(b){b.children?(b._children=b.children,b.children=null):(b.children=b._children,b._children=null),$("circle").removeClass("active"),$("g#unit-"+b.data.pk+" circle").addClass("active"),b.data.pk&&$.ajax({url:$(a).data("url")+b.data.pk+"/widget/",success:function(b){$($(a).data("target")).html(b)}}),c(b)});o.append("circle").attr("class","node").attr("r",1e-6).style("fill",function(a){return a._children?"#17a2b8":"#fff"}),o.append("text").attr("dy",".35em").attr("x",function(a){return a.children||a._children?-13:13}).attr("text-anchor",function(a){return a.children||a._children?"end":"start"}).text(function(a){return a.data.name});var p=o.merge(n);p.transition().duration(750).attr("transform",function(a){return"translate("+a.y+","+a.x+")"}),p.select("circle.node").attr("r",10).style("fill",function(a){return a._children?"#17a2b8":"#fff"}).attr("cursor","pointer");var q=n.exit().transition().duration(750).attr("transform",function(){return"translate("+f.y+","+f.x+")"}).remove();q.select("circle").attr("r",1e-6),q.select("text").style("fill-opacity",1e-6);var r=j.selectAll("path.link").data(m,function(a){return a.id}),s=r.enter().insert("path","g").attr("class","link").attr("d",function(){var a={x:f.x0,y:f.y0};return g(a,a)}),t=s.merge(r);t.transition().duration(750).attr("d",function(a){return g(a,a.parent)});r.exit().transition().duration(750).attr("d",function(){var a={x:f.x,y:f.y};return g(a,a)}).remove();i.forEach(function(a){a.x0=a.x,a.y0=a.y})}var d,e=$(a).parent(),f={top:20,right:90,bottom:30,left:90},g=e.width()-f.left-f.right,h=e.width()/2-f.top-f.bottom,j=d3.select(a).append("svg").attr("width",g+f.right+f.left).attr("height",h+f.top+f.bottom).append("g").attr("transform","translate("+f.left+","+f.top+")"),k=0,l=d3.tree().size([h,g]);d=d3.hierarchy(b,function(a){return a.children}),d.x0=h/2,d.y0=0,c(d),$(window).resize(function(){$(a+" svg").attr("width",e.width()),c(d)})}